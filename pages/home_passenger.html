<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Inicio Pasajero | ManiRuta</title>
  <link rel="stylesheet" href="../css/base.css"/>
  <link rel="stylesheet" href="../css/home.css"/>
</head>
<body>

  <!-- NAV -->
  <header class="nav">
    <div class="container nav-inner">
      <div class="nav-left">
        <button class="icon-btn" id="menuBtn" title="MenÃº" aria-label="MenÃº">
          <!-- hamburger -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>

        <div class="brand">
          <span class="dot"></span> ManiRuta
        </div>
      </div>

      <div class="nav-right">
        <span class="pill" id="who">...</span>

        <button class="icon-btn" id="settingsBtn" title="Ajustes" aria-label="Ajustes">
          <!-- gear -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="currentColor" stroke-width="2"/>
            <path d="M19.4 15a7.9 7.9 0 0 0 .1-2l2-1.2-2-3.4-2.3.7a7.4 7.4 0 0 0-1.7-1l-.3-2.4H10.8l-.3 2.4a7.4 7.4 0 0 0-1.7 1l-2.3-.7-2 3.4 2 1.2a7.9 7.9 0 0 0 .1 2l-2 1.2 2 3.4 2.3-.7c.5.4 1.1.7 1.7 1l.3 2.4h4.4l.3-2.4c.6-.3 1.2-.6 1.7-1l2.3.7 2-3.4-2-1.2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
          </svg>
        </button>

        <button class="btn btn-ghost" id="logout">Salir</button>
      </div>
    </div>
  </header>

  <main class="container home-wrap">

    <!-- Welcome -->
    <section class="card welcome">
      <div class="welcome-top">
        <div>
          <h1 id="welcomeTitle">ğŸ‘‹ Hola, pasajero</h1>
          <p>Consulta rutas en tiempo real, planea tu viaje y reporta incidentes rÃ¡pido.</p>
        </div>
        <span class="pill">ğŸšŒ Tiempo real</span>
      </div>

      <div class="footer-actions">
        <span class="badge">ğŸ“ Paraderos</span>
        <span class="badge">ğŸ§­ Planificador</span>
        <span class="badge">ğŸš¨ Alertas</span>
        <span class="badge">ğŸ›¡ï¸ Denuncias</span>
      </div>
    </section>

    <!-- Modules list (mockup style) -->
    <section class="feature-list">

      <a class="feature" href="#" id="goRoutes">
        <div class="feature-thumb">
          <div class="img" id="imgRoutes"></div>
          <div class="tag">ğŸ—ºï¸ Rutas</div>
        </div>
        <div>
          <h2>Rutas</h2>
          <p>Consulta buses y paraderos en tiempo real.</p>
          <div class="small-row">
            <span class="help">Ver rutas disponibles</span>
            <span class="chev">â€º</span>
          </div>
        </div>
      </a>

      <a class="feature" href="#" id="goPlanner">
        <div class="feature-thumb">
          <div class="img" id="imgPlanner"></div>
          <div class="tag">ğŸ§­ Planificador</div>
        </div>
        <div>
          <h2>Planificador</h2>
          <p>Encuentra la mejor ruta segÃºn tu ubicaciÃ³n.</p>
          <div class="small-row">
            <span class="help">Optimiza tu viaje</span>
            <span class="chev">â€º</span>
          </div>
        </div>
      </a>

      <a class="feature" href="#" id="goIncidents">
        <div class="feature-thumb">
          <div class="img" id="imgIncidents"></div>
          <div class="tag">ğŸš¨ Denuncias</div>
        </div>
        <div>
          <h2>Denuncias</h2>
          <p>Reporta incidentes de forma rÃ¡pida y anÃ³nima.</p>
          <div class="small-row">
            <span class="help">Crear denuncia</span>
            <span class="chev">â€º</span>
          </div>
        </div>
      </a>

      <a class="feature" href="#" id="goAlerts">
        <div class="feature-thumb">
          <div class="img" id="imgAlerts"></div>
          <div class="tag">ğŸ”” Alertas</div>
        </div>
        <div>
          <h2>Alertas</h2>
          <p>Recibe notificaciones sobre desvÃ­os y eventos.</p>
          <div class="small-row">
            <span class="help">Ver alertas</span>
            <span class="chev">â€º</span>
          </div>
        </div>
      </a>

    </section>
  </main>

  <script type="module">
    import { requireAuthAndRole } from "../js/guard.js";
    import { signOut } from "../js/auth.js";

    // ImÃ¡genes de prueba (cÃ¡mbialas luego por tus links de Supabase Storage)
    const IMG_ROUTES    = "https://advancedfleetmanagementconsulting.com/wp-content/uploads/2016/11/calcula-mejor-ruta-660x400.png"; // bus
    const IMG_PLANNER   = "https://blog.columbus-outdoor.com/wp-content/uploads/2018/12/como-hacer-una-ruta-google-maps-pc.jpg"; // mapa
    const IMG_INCIDENTS = "https://media.licdn.com/dms/image/v2/D4E12AQG4pe87F3YiGg/article-cover_image-shrink_720_1280/article-cover_image-shrink_720_1280/0/1663096582659?e=2147483647&v=beta&t=Q4Js9R1346mSwMneb3-RsMri04uondNEjJ7V-44kaWs"; // seguridad / alerta
    const IMG_ALERTS    = "https://www.dexiaabogados.com/wp-content/uploads/2021/01/denuncia.jpg"; // ciudad / notificaciÃ³n

    document.getElementById("imgRoutes").style.backgroundImage    = `url('${IMG_ROUTES}')`;
    document.getElementById("imgPlanner").style.backgroundImage   = `url('${IMG_PLANNER}')`;
    document.getElementById("imgIncidents").style.backgroundImage = `url('${IMG_INCIDENTS}')`;
    document.getElementById("imgAlerts").style.backgroundImage    = `url('${IMG_ALERTS}')`;

    // ProtecciÃ³n + perfil
    const profile = await requireAuthAndRole(1); // 1 = PASAJERO
    if (profile){
      document.getElementById("who").textContent = `@${profile.username}`;
      document.getElementById("welcomeTitle").textContent = `ğŸ‘‹ Hola, ${profile.username}`;
    }

    // Logout
    document.getElementById("logout").addEventListener("click", async () => {
      await signOut();
      window.location.href = "login.html"; // estÃ¡s dentro de /pages/
    });

    // Botones (por ahora placeholder)
    document.getElementById("goRoutes").addEventListener("click", (e) => {
      e.preventDefault();
      alert("ğŸ“Œ AquÃ­ irÃ¡ el mÃ³dulo de Rutas (pendiente).");
    });
    document.getElementById("goPlanner").addEventListener("click", (e) => {
      e.preventDefault();
      alert("ğŸ“Œ AquÃ­ irÃ¡ el Planificador (pendiente).");
    });
    document.getElementById("goIncidents").addEventListener("click", (e) => {
      e.preventDefault();
      window.location.href = "denuncias.html";;
    });
    document.getElementById("goAlerts").addEventListener("click", (e) => {
      e.preventDefault();
      alert("ğŸ“Œ AquÃ­ irÃ¡n Alertas (pendiente).");
    });

    // MenÃº/Ajustes placeholder
    document.getElementById("menuBtn").addEventListener("click", () => alert("â˜° MenÃº (pendiente)"));
    document.getElementById("settingsBtn").addEventListener("click", () => alert("âš™ï¸ Ajustes (pendiente)"));
  </script>
</body>
</html>





